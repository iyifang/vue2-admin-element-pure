{"remainingRequest":"D:\\Demo\\test\\vue2-admin-element-pure\\node_modules\\babel-loader\\lib\\index.js!D:\\Demo\\test\\vue2-admin-element-pure\\src\\permission.js","dependencies":[{"path":"D:\\Demo\\test\\vue2-admin-element-pure\\src\\permission.js","mtime":1662460432755},{"path":"D:\\Demo\\test\\vue2-admin-element-pure\\babel.config.js","mtime":1663636365809},{"path":"D:\\Demo\\test\\vue2-admin-element-pure\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Demo\\test\\vue2-admin-element-pure\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9yZWdlbmVyYXRvclJ1bnRpbWUgZnJvbSAiRDovRGVtby90ZXN0L3Z1ZTItYWRtaW4tZWxlbWVudC1wdXJlL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9yZWdlbmVyYXRvclJ1bnRpbWUuanMiOwppbXBvcnQgX01lc3NhZ2UyIGZyb20gImVsZW1lbnQtdWkvbGliL3RoZW1lLWNoYWxrL21lc3NhZ2UuY3NzIjsKaW1wb3J0ICJlbGVtZW50LXVpL2xpYi90aGVtZS1jaGFsay9iYXNlLmNzcyI7CmltcG9ydCBfTWVzc2FnZSBmcm9tICJlbGVtZW50LXVpL2xpYi9tZXNzYWdlIjsKaW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkQ6L0RlbW8vdGVzdC92dWUyLWFkbWluLWVsZW1lbnQtcHVyZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vYXN5bmNUb0dlbmVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmZ1bmN0aW9uLm5hbWUuanMiOwppbXBvcnQgcm91dGVyIGZyb20gIi4vcm91dGVyIjsKaW1wb3J0IHN0b3JlIGZyb20gIi4vc3RvcmUiOwppbXBvcnQgTlByb2dyZXNzIGZyb20gIm5wcm9ncmVzcyI7CmltcG9ydCAnbnByb2dyZXNzL25wcm9ncmVzcy5jc3MnOwppbXBvcnQgeyBnZXRUb2tlbiB9IGZyb20gJ0AvdXRpbHMvYXV0aCc7CmltcG9ydCBnZXRQYWdlVGl0bGUgZnJvbSAnQC91dGlscy9nZXQtcGFnZS10aXRsZSc7Ck5Qcm9ncmVzcy5jb25maWd1cmUoewogIHNob3dTcGlubmVyOiBmYWxzZQp9KTsKdmFyIHdoaXRlTGlzdCA9IFsnL2xvZ2luJ107IC8vIOeZveWQjeWNlQoKcm91dGVyLmJlZm9yZUVhY2goIC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgdmFyIF9yZWYgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUodG8sIGZvcm0sIG5leHQpIHsKICAgIHZhciBoYXNUb2tlbiwgaGFzR2V0VXNlckluZm87CiAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgd2hpbGUgKDEpIHsKICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIE5Qcm9ncmVzcy5zdGFydCgpOyAvLyDorr7nva7pobXpnaLmoIfpopgKCiAgICAgICAgICAgIGRvY3VtZW50LnRpdGxlID0gZ2V0UGFnZVRpdGxlKHRvLm1ldGEudGl0bGUpOwogICAgICAgICAgICBoYXNUb2tlbiA9IGdldFRva2VuKCk7CgogICAgICAgICAgICBpZiAoIWhhc1Rva2VuKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI5OwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoISh0by5wYXRoID09PSAnL2xvZ2luJykpIHsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gOTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgbmV4dCh7CiAgICAgICAgICAgICAgcGF0aDogJy8nCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBOUHJvZ3Jlc3MuZG9uZSgpOwogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjc7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgaGFzR2V0VXNlckluZm8gPSBzdG9yZS5nZXR0ZXJzLm5hbWU7CgogICAgICAgICAgICBpZiAoIWhhc0dldFVzZXJJbmZvKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE0OwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICBuZXh0KCk7CiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyNzsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDE0OwogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTc7CiAgICAgICAgICAgIHJldHVybiBzdG9yZS5kaXNwYXRjaCgndXNlci9nZXRJbmZvJyk7CgogICAgICAgICAgY2FzZSAxNzoKICAgICAgICAgICAgbmV4dCgpOwogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjc7CiAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgIGNhc2UgMjA6CiAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAyMDsKICAgICAgICAgICAgX2NvbnRleHQudDAgPSBfY29udGV4dFsiY2F0Y2giXSgxNCk7CiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyNDsKICAgICAgICAgICAgcmV0dXJuIHN0b3JlLmRpc3BhdGNoKCd1c2VyL3Jlc2V0VG9rZW4nKTsKCiAgICAgICAgICBjYXNlIDI0OgogICAgICAgICAgICBfTWVzc2FnZS5lcnJvcihfY29udGV4dC50MCB8fCAnSGFzIEVycm9yJyk7CgogICAgICAgICAgICBuZXh0KCIvbG9naW4/cmVkaXJlY3Q9Ii5jb25jYXQodG8ucGF0aCkpOwogICAgICAgICAgICBOUHJvZ3Jlc3MuZG9uZSgpOwoKICAgICAgICAgIGNhc2UgMjc6CiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzMDsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAyOToKICAgICAgICAgICAgLy8g5rKh5pyJ5Luk54mMCiAgICAgICAgICAgIGlmICh3aGl0ZUxpc3QuaW5kZXhPZih0by5wYXRoKSAhPT0gLTEpIHsKICAgICAgICAgICAgICAvLyDlnKjnmb3lkI3ljZXlhoUKICAgICAgICAgICAgICBuZXh0KCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgLy8g6YO95rKh5pyJ5bCx6Lez6L2s5Yiw55m75b2V6aG1CiAgICAgICAgICAgICAgbmV4dCgibG9naW4/cmVkaXJlY3Q9Ii5jb25jYXQodG8ucGF0aCkpOwogICAgICAgICAgICAgIE5Qcm9ncmVzcy5kb25lKCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICBjYXNlIDMwOgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIF9jYWxsZWUsIG51bGwsIFtbMTQsIDIwXV0pOwogIH0pKTsKCiAgcmV0dXJuIGZ1bmN0aW9uIChfeCwgX3gyLCBfeDMpIHsKICAgIHJldHVybiBfcmVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgfTsKfSgpKTsKcm91dGVyLmFmdGVyRWFjaChmdW5jdGlvbiAoKSB7CiAgTlByb2dyZXNzLmRvbmUoKTsKfSk7"},{"version":3,"names":["router","store","NProgress","getToken","getPageTitle","configure","showSpinner","whiteList","beforeEach","to","form","next","start","document","title","meta","hasToken","path","done","hasGetUserInfo","getters","name","dispatch","error","indexOf","afterEach"],"sources":["D:/Demo/test/vue2-admin-element-pure/src/permission.js"],"sourcesContent":["import router from \"./router\"\r\nimport store from \"./store\"\r\nimport { Message } from 'element-ui'\r\nimport NProgress from \"nprogress\"\r\nimport 'nprogress/nprogress.css'\r\nimport { getToken } from '@/utils/auth'\r\nimport getPageTitle from '@/utils/get-page-title'\r\n\r\nNProgress.configure({ showSpinner: false })\r\n\r\nconst whiteList = ['/login'] // 白名单\r\n\r\nrouter.beforeEach(async (to, form, next) => {\r\n  NProgress.start()\r\n\r\n  // 设置页面标题\r\n  document.title = getPageTitle(to.meta.title)\r\n\r\n  const hasToken = getToken()\r\n  if (hasToken) {\r\n    if (to.path === '/login') {\r\n      next({ path: '/' })\r\n      NProgress.done()\r\n    } else {\r\n      const hasGetUserInfo = store.getters.name\r\n      if (hasGetUserInfo) {\r\n        next()\r\n      } else {\r\n        try {\r\n          // 获取最新用户信息\r\n          await store.dispatch('user/getInfo')\r\n          next()\r\n        } catch (error) {\r\n          // 清除令牌跳转登录页\r\n          await store.dispatch('user/resetToken')\r\n          Message.error(error || 'Has Error')\r\n          next(`/login?redirect=${to.path}`)\r\n          NProgress.done()\r\n        }\r\n      }\r\n    }\r\n  } else {\r\n    // 没有令牌\r\n    if (whiteList.indexOf(to.path) !== -1) {\r\n      // 在白名单内\r\n      next()\r\n    } else {\r\n      // 都没有就跳转到登录页\r\n      next(`login?redirect=${to.path}`)\r\n      NProgress.done()\r\n    }\r\n  }\r\n})\r\n\r\nrouter.afterEach(() => {\r\n  NProgress.done()\r\n})\r\n"],"mappings":";;;;;;AAAA,OAAOA,MAAP,MAAmB,UAAnB;AACA,OAAOC,KAAP,MAAkB,SAAlB;AAEA,OAAOC,SAAP,MAAsB,WAAtB;AACA,OAAO,yBAAP;AACA,SAASC,QAAT,QAAyB,cAAzB;AACA,OAAOC,YAAP,MAAyB,wBAAzB;AAEAF,SAAS,CAACG,SAAV,CAAoB;EAAEC,WAAW,EAAE;AAAf,CAApB;AAEA,IAAMC,SAAS,GAAG,CAAC,QAAD,CAAlB,C,CAA6B;;AAE7BP,MAAM,CAACQ,UAAP;EAAA,sEAAkB,iBAAOC,EAAP,EAAWC,IAAX,EAAiBC,IAAjB;IAAA;IAAA;MAAA;QAAA;UAAA;YAChBT,SAAS,CAACU,KAAV,GADgB,CAGhB;;YACAC,QAAQ,CAACC,KAAT,GAAiBV,YAAY,CAACK,EAAE,CAACM,IAAH,CAAQD,KAAT,CAA7B;YAEME,QANU,GAMCb,QAAQ,EANT;;YAAA,KAOZa,QAPY;cAAA;cAAA;YAAA;;YAAA,MAQVP,EAAE,CAACQ,IAAH,KAAY,QARF;cAAA;cAAA;YAAA;;YASZN,IAAI,CAAC;cAAEM,IAAI,EAAE;YAAR,CAAD,CAAJ;YACAf,SAAS,CAACgB,IAAV;YAVY;YAAA;;UAAA;YAYNC,cAZM,GAYWlB,KAAK,CAACmB,OAAN,CAAcC,IAZzB;;YAAA,KAaRF,cAbQ;cAAA;cAAA;YAAA;;YAcVR,IAAI;YAdM;YAAA;;UAAA;YAAA;YAAA;YAAA,OAkBFV,KAAK,CAACqB,QAAN,CAAe,cAAf,CAlBE;;UAAA;YAmBRX,IAAI;YAnBI;YAAA;;UAAA;YAAA;YAAA;YAAA;YAAA,OAsBFV,KAAK,CAACqB,QAAN,CAAe,iBAAf,CAtBE;;UAAA;YAuBR,SAAQC,KAAR,CAAc,eAAS,WAAvB;;YACAZ,IAAI,2BAAoBF,EAAE,CAACQ,IAAvB,EAAJ;YACAf,SAAS,CAACgB,IAAV;;UAzBQ;YAAA;YAAA;;UAAA;YA8Bd;YACA,IAAIX,SAAS,CAACiB,OAAV,CAAkBf,EAAE,CAACQ,IAArB,MAA+B,CAAC,CAApC,EAAuC;cACrC;cACAN,IAAI;YACL,CAHD,MAGO;cACL;cACAA,IAAI,0BAAmBF,EAAE,CAACQ,IAAtB,EAAJ;cACAf,SAAS,CAACgB,IAAV;YACD;;UAtCa;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,CAAlB;;EAAA;IAAA;EAAA;AAAA;AA0CAlB,MAAM,CAACyB,SAAP,CAAiB,YAAM;EACrBvB,SAAS,CAACgB,IAAV;AACD,CAFD"}]}